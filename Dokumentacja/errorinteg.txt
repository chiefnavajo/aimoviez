Vulnerabilities Found — DB allows, API must enforce
  ┌─────┬──────────────┬───────────────────────────────────────────────────────────────────────────────┬──────────────────────────────┐
  │  #  │   Category   │                                    Finding                                    │           Severity           │
  ├─────┼──────────────┼───────────────────────────────────────────────────────────────────────────────┼──────────────────────────────┤
  │ 1   │ Credits      │ deduct_credits(-10) adds credits instead of deducting                         │ Critical                     │
  ├─────┼──────────────┼───────────────────────────────────────────────────────────────────────────────┼──────────────────────────────┤
  │ 2   │ Credits      │ add_credits(-10) drains balance                                               │ Critical                     │
  ├─────┼──────────────┼───────────────────────────────────────────────────────────────────────────────┼──────────────────────────────┤
  │ 3   │ Auth         │ Service role can set is_admin=true on any user                                │ High (RLS-dependent)         │
  ├─────┼──────────────┼───────────────────────────────────────────────────────────────────────────────┼──────────────────────────────┤
  │ 4   │ Auth         │ admin_approve_clip_atomic RPC has no internal admin check                     │ High                         │
  ├─────┼──────────────┼───────────────────────────────────────────────────────────────────────────────┼──────────────────────────────┤
  │ 5   │ Auth         │ Any user can read other users' AI generations, notifications via service role │ High (RLS-dependent)         │
  ├─────┼──────────────┼───────────────────────────────────────────────────────────────────────────────┼──────────────────────────────┤
  │ 6   │ Auth         │ Any user can modify another user's clips via service role                     │ High (RLS-dependent)         │
  ├─────┼──────────────┼───────────────────────────────────────────────────────────────────────────────┼──────────────────────────────┤
  │ 7   │ Auth         │ Non-leader can update team name via service role                              │ Medium                       │
  ├─────┼──────────────┼───────────────────────────────────────────────────────────────────────────────┼──────────────────────────────┤
  │ 8   │ Banned users │ Banned users can insert votes at DB level                                     │ Medium                       │
  ├─────┼──────────────┼───────────────────────────────────────────────────────────────────────────────┼──────────────────────────────┤
  │ 9   │ Banned users │ Banned users can insert comments at DB level                                  │ Medium                       │
  ├─────┼──────────────┼───────────────────────────────────────────────────────────────────────────────┼──────────────────────────────┤
  │ 10  │ Voting       │ No unique constraint on (voter_key, clip_id) — 500 duplicate votes possible   │ Medium                       │
  ├─────┼──────────────┼───────────────────────────────────────────────────────────────────────────────┼──────────────────────────────┤
  │ 11  │ Voting       │ Can vote on rejected/locked clips                                             │ Medium                       │
  ├─────┼──────────────┼───────────────────────────────────────────────────────────────────────────────┼──────────────────────────────┤
  │ 12  │ Voting       │ Self-voting allowed (voter_key = uploader)                                    │ Low                          │
  ├─────┼──────────────┼───────────────────────────────────────────────────────────────────────────────┼──────────────────────────────┤
  │ 13  │ Flooding     │ 100 rapid comments from same user — no DB rate limit                          │ Medium                       │
  ├─────┼──────────────┼───────────────────────────────────────────────────────────────────────────────┼──────────────────────────────┤
  │ 14  │ Flooding     │ Unlimited comment nesting depth (50+ levels tested)                           │ Low                          │
  ├─────┼──────────────┼───────────────────────────────────────────────────────────────────────────────┼──────────────────────────────┤
  │ 15  │ Teams        │ No max team member count at DB level (11 inserted directly)                   │ Low                          │
  ├─────┼──────────────┼───────────────────────────────────────────────────────────────────────────────┼──────────────────────────────┤
  │ 16  │ Referrals    │ Self-referral allowed (referrer_id == referred_id)                            │ Medium                       │
  ├─────┼──────────────┼───────────────────────────────────────────────────────────────────────────────┼──────────────────────────────┤
  │ 17  │ Referrals    │ Can claim reward before referral is completed                                 │ Medium                       │
  ├─────┼──────────────┼───────────────────────────────────────────────────────────────────────────────┼──────────────────────────────┤
  │ 18  │ URLs         │ javascript:, data:, internal IPs stored in video_url/thumbnail_url            │ Medium (sanitizeUrl handles) │
  ├─────┼──────────────┼───────────────────────────────────────────────────────────────────────────────┼──────────────────────────────┤
  │ 19  │ Email        │ CRLF injection in contact_submissions email field                             │ Low                          │
  ├─────┼──────────────┼───────────────────────────────────────────────────────────────────────────────┼──────────────────────────────┤
  │ 20  │ JSON         │ __proto__ pollution payloads stored in jsonb metadata                         │ Low                          │
  ├─────┼──────────────┼───────────────────────────────────────────────────────────────────────────────┼──────────────────────────────┤
  │ 21  │ Slot state   │ Can set winner on non-locked slot                                             │ Low                          │
  └─────┴──────────────┴───────────────────────────────────────────────────────────────────────────────┴────────